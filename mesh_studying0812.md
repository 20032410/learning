# 学习书籍

### 网页
* 学习git最基础书籍
	Raspberry Pi 上的[分布式网络](https://linux.cn/article-8499-1.html)

	我通过 kubeadm 发现了 Weave Net。Weave Mesh 是一个有趣的分布式网络解决方案，因此我开始了解更多关于它的内容。在 2016 年 12 月，我在 Weaveworks 收到了第一份合同工作，我成为了 Weave Net 中 ARM 支持团队的一员。

	我很高兴可以在 Raspberry Pi 上运行 Weave Net 的工业案例，比如那些需要设备更加移动化的工厂。目前，将 Weave Scope 或 Weave Cloud 部署到 Raspberry Pi 可能不太现实（尽管可以考虑使用其他 ARM 设备），因为我猜这个软件需要更多的内存才能运行良好。理想情况下，随着 Raspberry Pi 升级到 2GB 内存，我想我可以在它上面运行 Weave Cloud 了。

	在 Weave Net 1.9 中，Weave Net 支持了 ARM。Kubeadm（通常是 Kubernetes）在多个平台上工作。你可以使用 Weave 将 Kubernetes 部署到 ARM，就像在任何 AMD64 设备上一样安装 Docker、kubeadm、kubectl 和 kubelet。然后初始化控制面板组件运行的主机：
* [mesh实验](https://www.bbsmax.com/A/kvJ3E26Ddg/)笔者使用上图所示的拓扑测试了网络的连通性，发现如果计算机A和计算B是win系统的话，则需要在1、2两个节点上执行iptables -t nat  -A POSTROUTING -o eth0 -j MASQUERADE命令，也就是说，要在节点1的POSTROUTING处为笔记本B做网络地址转换（对源地址做NAT），这样B才能ping通A；同理，在节点2的POSTROUTING处为笔记本A做网络地址转换（对源地址做NAT），这样A才能ping通B。但是如果计算机A和B为linux系统的话，就不需要做NAT。因此笔者猜测win系统和linux在处理包转发或包回复时机制是不同的，至于是不是这样，还有待于研究。


* 普通的pc linux或arm linux的网络层默认情况下，是没有开启路由转发功能的，当系统收到的数据包不是发给本机的，会将数据包丢弃；因此当pc或者开发版作为路由器时，必须要激活路由转发模块。命令为：echo “1”  > /proc/sys/net/ipv4/ip_forward。这样就激活了主机的路由转发模块。
* 通过实验，笔者对网络的很多概念，包括ip地址、默认网关、路由表、arp表、路由表项、arp表项等等有了更深一步的认识。笔者觉得，ip地址虽然进行了A/B/C/D/E类划分，甚至划分了公网ip和局域网ip，可是就ip地址本身而言，它们之间没有任何本质区别，在这种自组织的ip地址分配中，可以任意使用所有ip地址。因此笔者在对全网进行ip地址规划时，将mesh骨干网的所有节点的ip地址划为一个网段，将连接在某个骨干网节点的所有客户端划为一个网段，并称其为“局域网”，连接在不同骨干网节点上的若干个局域网之间绝不能处于同一个网段，也不能和骨干网处于同一网段。示意图如下：
* 细心的实验者还应该发现，当不运行aodv协议时，这些节点之间有时也是可以连通的。其实这是对的，如果骨干网的所有节点都处于同一网段，那么arp协议会自动获取本网段内所有节点的ip地址和mac地址，并初始化节点的arp表和路由表，使得本网段的主机可以直接通信；这就和以太网内所有主机处于同一网段，也可以互相通信是一个道理。如果骨干网内的所有节点并不在同一网段的时候，就需要aodv协议来进行路由探索了。另外，骨干网内，信号不能相互覆盖的节点（即不是邻居节点），也需要aodv协议进行路由探索，aodv协议一旦探索成功路由，并将路由信息更新至内核的路由表中，其就失去作用了（可以粗略这么理解）。
* 最后，还要更正网上一些同类文章中错误的概念。他们认为节点上的两张无线网卡需要使用NAT方式连通，这属于概念性错误。其实在linux系统中，无论你插入多少张无线网卡，只要安装好了网卡驱动，这些网卡本身就是连通的，也就是说，每个网卡的ip地址和Mac地址都会被记录到路由表和arp表中，ip协议可以正确的将数据包通过相应的网卡发送出去。这和NAT方式压根没任何关系，NAT用来做网络地址转换，也就是说它会修改数据包的源地址或目的地址（对源地址做转换或对目的地址做转换，具体要根据需求来定），将其改为所设置的ip地址。NAT的作用在于，假如某些内网主机要通过一台连接在公网上的主机去上网，如果不做NAT，内网主机发送到互联网上的数据包，互联网站点是无法返回数据包的（返回的那些主机是内网主机，其ip地址为内网地址），所以这些内网主机是无法上网的；因此需要在连接到公网的那台主机上对这些内网主机数据包的源地址做NAT，将源地址转换为公网主机的ip地址，这时内网主机发送到互联网上的数据包，互联网可以做应答的，将应答包发送给这台公网主机，该主机再逆向根据NAT规则，将应答包交给某个内网主机。因此内网主机就可以上网了。
* [使用arm开发板搭建无线mesh网络](https://www.bbsmax.com/A/gGdX7wnp54/)
* 　　为了解决上述的问题，无线mesh网络应运而生。无线mesh网络从本质上讲，还是无线自组织网络（adhoc），只不过无线mesh网络在adhoc的基础上抽象出了一个骨干网（mesh）。不像adhoc网络那样，所有节点都由用户的终端设备承担，而且所有节点之间都是完全对等的关系，移动性很强。无线mesh网络的骨干网是由专门的网络设备（路由器等）组建的，而且组成骨干网的这些设备一般是不移动的或者是弱移动性的。这将解决掉上述adhoc网络所面临的很多问题。首先，骨干网节点由专门的路由设备来承担，这些路由设备不用处理用户的应用数据，只用来做路由转发的任务，因此所有的软硬件资源都是为路由转发服务的，因此可以承担大拓扑结构（大拓扑结构的网络首先需要网络设备具有足够大的存储空间来存储庞大的路由表，而且需要较强的处理器在路由表中随时查找或更新路由条目）、大数量的路由转发任务；其次，骨干网节点不移动，那么节点也不存在电力供应不足的问题，可以直接使用固定电源来供电，因此骨干网节点的这些设备在软硬件选择上，就不考虑功耗问题，性能无上限；再次，骨干网节点不移动，整个mesh网络拓扑将是稳定的，mesh网络的可靠性、应用的现实性也就具备了。下面给出adhoc网络和无线mesh网络的拓扑图示，以示其区别：




	
